FAQ
==========

Q1: PiDog 有哪些版本？
------------------------------------------------------

PiDog 目前有 **标准版** 和 **V2 版**：

* **标准版**：支持 Raspberry Pi 3B+/4B/Zero 2W，**不支持** Raspberry Pi 5。  
* **V2 版**：支持 Raspberry Pi 3/4/5 和 Zero 2W，对 Robot HAT 和舵机驱动电路进行了改进，为 Pi 5 提供更好的供电能力。  
* **供电能力**：V2 增强了电源管理，更适合高功耗应用。

---

Q2: 如何安装依赖模块？
--------------------------------------------------

.. code-block:: bash

    # Robot HAT
    git clone -b 2.5.x https://github.com/sunfounder/robot-hat.git --depth 1
    cd robot-hat && sudo python3 install.py

    # Vilib
    git clone https://github.com/sunfounder/vilib.git
    cd vilib && sudo python3 install.py

    # PiDog
    git clone https://github.com/sunfounder/pidog.git --depth 1
    cd pidog && sudo python3 setup.py install

如果没有声音，请执行：

.. code-block:: bash

    # I2S 音频驱动
    cd ~/robot-hat
    sudo bash i2samp.sh

如果仍无声音，可能需要多运行几次。

---

Q3: 如何运行第一个示例程序？
-------------------------------------

.. code-block:: bash

    cd ~/pidog/examples
    sudo python3 1_wake_up.py

运行后，PiDog 会抬起头，坐下，并摇尾巴。

---

Q4: PiDog 有哪些内置动作和声音？
------------------------------------------------------

* 动作（Actions）： ``stand``、 ``sit``、 ``wag_tail``、 ``trot`` 等。  
* 声音（Sounds）： ``bark``、 ``howling``、 ``pant`` 等。

运行：

.. code-block:: bash

    sudo python3 2_function_demonstration.py

根据提示输入数字即可触发不同动作。

---

Q5: PiDog 如何使用传感器？
-------------------------------------

* **超声波**：用于避障与巡逻。  
* **触摸传感器**：前方触摸 = 警觉；后方触摸 = 享受。  
* **声源方向**：识别声音方向并响应。

---

Q6: PiDog 支持哪些 AI 功能？
------------------------------------------------------

PiDog 集成了 **TTS（语音合成）**、**STT（语音识别）** 和 **LLM（大语言模型）**：

* **TTS**：Espeak、Pico2Wave、Piper、OpenAI。  
* **STT**：Vosk（离线）。  
* **LLM**：Ollama（本地）、OpenAI（在线）。

---

Q7: 是否需要校准舵机？
---------------------------------------------

需要。无论标准版还是 V2 版本，都必须进行 **舵机零位校准**，以确保动作稳定并防止损坏。

**V2 版本**

按下 Robot HAT 上的 **归零按键**，即可让所有舵机自动回到 0°，无需运行脚本，操作更方便。

**标准版**

在安装前需运行归零脚本：

.. code-block:: bash

   cd ~/pidog/examples
   sudo python3 servo_zeroing.py

安装后（适用于两个版本），需要根据标尺手动调整舵机角度，使四肢姿态正确，以避免运动不稳定、机械卡顿或过度拉伸，保证行走和姿态控制的准确性。

----

Q8: 为什么 PiDog 行走不稳定？
-----------------------------------------------

* 确认所有舵机均在 0° 位置安装。  
* 确保舵机角度与标尺刻度（60°/90°）一致。  
* 检查电池是否充满。  
* 拧紧所有舵机螺丝。

----

Q9: 为什么摄像头无法工作？
--------------------------------------

* 确保摄像头排线 **牢固插入** CSI 接口，并锁紧黑色卡扣。  
* **断电** 后再插拔摄像头，避免损坏。  
* 使用 ``libcamera-hello`` 或 ``raspistill`` 测试摄像头输出是否正常。  
* 如果连接松动或插反，请重新插拔排线。

----

Q10: 为什么扬声器没有声音？
--------------------------------------

* 确认系统音量未静音且已正确安装 I2S 音频驱动。  
* 如果没有声音，可重新配置 I2S：

.. code-block:: bash

    cd ~/robot-hat
    sudo bash i2samp.sh

* 运行脚本后请重启树莓派。

----

Q11: 为什么麦克风无法工作？
--------------------------------------

* 先检查系统是否识别到麦克风：

.. code-block:: bash

    arecord -l

* 再测试录音功能：

.. code-block:: bash

    arecord -D plughw:1,0 -f cd test.wav

* 如果没有录到声音，检查输入设备设置，或使用 ``alsamixer`` 调整输入音量。  
* 确保没有其他进程占用麦克风设备。

----

Q12: 为什么声源方向传感器没有反应？
-------------------------------------------------------

* 确保声源方向传感器正确连接到 SPI 接口。  
* 检查排线是否松动或接反。  
* 确保电源稳定且传感器未被遮挡。  
* 重启设备并重新运行示例程序进行测试。

----

Q13: 为什么触摸传感器没有反应？
----------------------------------------------

* 确保所有触摸传感器排线连接牢固。  
* 注意：**低电平（LOW）** 表示被触摸。  
* 使用 ``gpio readall`` 或 Python 代码检测 GPIO 信号是否变化。  
* 检查接线方向是否正确。

----

Q14: 为什么 LED 灯板不亮或闪烁异常？
---------------------------------------------------------------------

* 确认 LED 板由 **3.3V** 供电，并连接到 I2C 接口。  
* 确保树莓派已启用 **I2C 功能**。  
* 使用以下命令检测设备是否被识别：

.. code-block:: bash

    i2cdetect -y 1

* 如果没有识别到设备，请重新检查接线并重启树莓派。

----

Q15: PiDog 如何供电？
------------------------------------------

* 使用 5V 3A Type-C 电源适配器。  
* 红灯亮 = 充电中，熄灭 = 充满。  
* 可以在充电时供电使用。  
* 如果指示灯不亮，请先充电。

----

